"use strict";function InitControls(){markPlaceAddress=document.getElementById("markPlaceAddress"),frmAdvanceSearch=document.getElementById("frmAdvanceSearch"),rangePriceLabel=document.getElementById("rangePriceLabel"),rangeRoomLabel=document.getElementById("rangeRoomLabel"),rangeSizeLabel=document.getElementById("rangeSizeLabel"),userInput=document.getElementById("UserInput")}function BindingEvent(){markPlaceAddress.addEventListener("keypress",function(a){var e=a.keyCode?a.keyCode:a.which;13===e&&btnSearch.click()}),markPlaceAddress.addEventListener("keyup",function(a){userInput.value=a.target.value})}function InitComboboxSearchType(){var a=document.getElementById("SelectedPropertyGroupType");a.addEventListener("change",function(a){Site.RemoveClass("._p-check-property-type","show"),Site.AddClass("._p-check-property-type","hide");for(var e=a.target.value,t=document.querySelectorAll("._p-check-property-type"),n=0;n<t.length;n++){var i=t[n];if(i.dataset.value===e){Site.RemoveClassElement(i,"hide"),Site.AddClassElement(i,"show");var o=i.dataset.refix;frmAdvanceSearch.action=frmAdvanceSearch.dataset.actionTemplate.replace("REFIX",o).replace("{PAGE}",1)}}}),a.dispatchEvent(new Site.CreateEvent("change"))}function InnitElasticSearch(){var a=LocalStorageHelper.Get(LocalStogeEnum.SELECTED_LOCATION_STORAGE_NAME);fuzzyComplete=new BcFuzzySearch,fuzzyComplete.Init("#markPlaceAddress",null!=a?a.id:null,null!=a?a.address:"","address","id",LocalStogeEnum.ALL_PLACES,bindingDataCompleteCallBack,bindingDataFailedCallback,selectionCallback,"#frmAdvanceSearch #PlaceId",10,3),a&&(markPlaceAddress.value=a.address)}function bindingDataCompleteCallBack(a,e){}function bindingDataFailedCallback(a,e){Site.NotifyFormFailed("LỖI","Lấy dự liệu thất bại. Vui lòng làm mới lại trang. Hoặc thông báo cho chugn1 tôi biết quá webmaster@baocat.vn")}function selectionCallback(a,e,t){if(console.log(t),e){LocalStorageHelper.Save(LocalStogeEnum.SELECTED_LOCATION_STORAGE_NAME,{id:t,address:e.item.display});var n=SeoUrl.MapSearchUrl(frmAdvanceSearch.dataset.refix,e.item.display,t,1);frmAdvanceSearch.action=n}else frmSubmit.placeId.value=null}function InputSearchInputCallBack(a){}function InitSlider(){var a,e,t=document.getElementById("rangePrice");noUiSlider.create(t,{range:{min:[0],"5%":[2e8,1e8],"70%":[4e9,1e9],"80%":[1e10,2e9],"95%":[2e10,5e9],max:[25e9]},start:[0,25e9],step:1e8,connect:!0,pips:{mode:"count",values:9,density:2,stepped:!0,format:wNumb({decimals:0,edit:function(a){return a=+a,0===a?0:25e9===a?"...":a<1e9?a/1e6+" tr":a/1e9+" tỷ"}})}}),a=t.dataset.min||0,e=t.dataset.max||99999999999999,t.noUiSlider.set([a,e]),t.noUiSlider.on("update",function(a,e){var t,n;frmAdvanceSearch.RangePriceMin.value=null,frmAdvanceSearch.RangePriceMax.value=null,0===+a[0]?t="Dưới ":25e9===+a[0]?t="":+a[0]<1e9?(t=+a[0]/1e6+" triệu",frmAdvanceSearch.RangePriceMin.value=+a[0]):(t=+a[0]/1e9+" tỷ",frmAdvanceSearch.RangePriceMin.value=+a[0]),0===+a[1]?t="":25e9===+a[1]?0===+a[0]?(n="Tất cả",t=""):(n="",t="Trên "+t):+a[1]<1e9?(n=+a[1]/1e6+" triệu",frmAdvanceSearch.RangePriceMax.value=+a[1]):(n=+a[1]/1e9+" tỷ",frmAdvanceSearch.RangePriceMax.value=+a[1]),n===t&&(t=""),""!==t&&""!==n&&0!==+a[0]&&(t+=" - "),rangePriceLabel.innerText=t+n});var n=document.getElementById("rangeRoom");noUiSlider.create(n,{range:{min:[0],"95%":[10,1],max:[11]},start:[0,100],step:1,stepped:!0,connect:!0,pips:{mode:"count",values:12,density:1,stepped:!0,format:wNumb({decimals:0,edit:function(a){return a=+a,0===a?0:11===a?"...":a}})}}),a=n.dataset.min||0,e=n.dataset.max||99999999999999,n.noUiSlider.set([a,e]),n.noUiSlider.on("update",function(a,e){var t,n;frmAdvanceSearch.RangeRoomMin.value=null,frmAdvanceSearch.RangeRoomMax.value=null,0===+a[0]?t="Dưới ":11===+a[0]?t="":(t=+a[0],frmAdvanceSearch.RangeRoomMin.value=+a[0]),0===+a[1]?t="":11===+a[1]?0===+a[0]?(n="Tất cả",t=""):(n="",t="Trên "+t):(n=+a[1],frmAdvanceSearch.RangeRoomMax.value=+a[1]),n===t&&(t=""),""!==t&&""!==n&&0!==+a[0]&&(t+=" - "),rangeRoomLabel.innerText=t+n});var i=document.getElementById("rangeSize");noUiSlider.create(i,{range:{min:[0],"5%":[20,10],"30%":[100,10],"70%":[300,10],"95%":[1e3,10],max:[1010]},start:[0,1e4],step:10,density:1,connect:!0,pips:{mode:"values",values:[30,50,100,150,200,250,300,500,700,900,1010],format:wNumb({decimals:0,edit:function(a){return a=+a,0===a?0:1010===a?"...":a}})}}),a=i.dataset.min||0,e=i.dataset.max||99999999999999,i.noUiSlider.set([a,e]),i.noUiSlider.on("update",function(a,e){var t,n;frmAdvanceSearch.RangeSizeMin.value=null,frmAdvanceSearch.RangeSizeMax.value=null,0===+a[0]?t="Dưới ":1010===+a[0]?t="":(t=+a[0],frmAdvanceSearch.RangeSizeMin.value=Math.round(a[0])),0===+a[1]?t="":1010===+a[1]?0===+a[0]?(n="Tất cả",t=""):(n="",t="Trên "+t+" m<sup class='text-12'>2<sup/>"):(n=+a[1]+" m<sup class='text-12'>2<sup/>",frmAdvanceSearch.RangeSizeMax.value=Math.round(a[1])),n===t&&(t=""),""!==t&&""!==n&&0!==+a[0]&&(t+=" - "),rangeSizeLabel.innerHTML=t+n})}function InitPaging(){for(var a=document.querySelectorAll("#pagination li button"),e=0;e<a.length;e++)a[e].addEventListener("click",function(a){a.preventDefault();var e=document.querySelector("._p-ListAgentPaging #PageNumber");e.value=parseInt(a.target.value);var t=document.querySelector("#agentContainer [name='submitType']");t.click()})}function InitPage(){var a=document.getElementById("tabBackupAgent");a.addEventListener("change",function(a){if(a.target.checked){var e=document.querySelector("#backupAgentContainer form[data-lazy-form=False]");if(e){var t=e.querySelector("[name='submitType']");t.click()}}})}function LoadMap(){}!function(a){function e(a,e){for(var t=window,n=(a||"").split(".");t&&n.length;)t=t[n.shift()];return"function"==typeof t?t:(e.push(a),Function.constructor.apply(null,e))}function t(a){return"GET"===a||"POST"===a}function n(a,e){t(e)||a.setRequestHeader("X-HTTP-Method-Override",e)}function i(e,t,n){var i;t&&void 0!==t.isUpdateLayout&&!t.isUpdateLayout||n.indexOf("application/x-javascript")===-1&&(i=(e.getAttribute("data-ajax-mode")||"").toUpperCase(),a(e.getAttribute("data-ajax-update")).each(function(e,n){var o;switch(i){case"BEFORE":o=n.firstChild,a("<div />").html(t).contents().each(function(){n.insertBefore(this,o)});break;case"AFTER":a("<div />").html(t).contents().each(function(){n.appendChild(this)});break;case"REPLACE-WITH":a(n).replaceWith(t);break;default:a(n).html(t)}}))}function o(o,r){var c,g,s,l;c=o.getAttribute("data-ajax-confirm"),c&&!window.confirm(c)||(g=a(o.getAttribute("data-ajax-loading")),l=parseInt(o.getAttribute("data-ajax-loading-duration"),10)||0,a.extend(r,{type:o.getAttribute("data-ajax-method")||void 0,url:o.getAttribute("data-ajax-url")||void 0,cache:!!o.getAttribute("data-ajax-cache"),beforeSend:function(a){var t;return n(a,s),t=e(o.getAttribute("data-ajax-begin"),["xhr"]).apply(o,arguments),t!==!1&&g.show(l),t},complete:function(){g.hide(l),e(o.getAttribute("data-ajax-complete"),["xhr","status"]).apply(o,arguments),console.log("complete")},success:function(a,t,n){i(o,a,n.getResponseHeader("Content-Type")||"text/html"),e(o.getAttribute("data-ajax-success"),["data","status","xhr"]).apply(o,arguments),console.log("success")},error:function(){e(o.getAttribute("data-ajax-failure"),["xhr","status","error"]).apply(o,arguments),console.log("error")}}),r.data.push({name:"X-Requested-With",value:"XMLHttpRequest"}),s=r.type.toUpperCase(),t(s)||(r.type="POST",r.data.push({name:"X-HTTP-Method-Override",value:s})),a.ajax(r))}function r(e){var t=a(e).data(s);return!t||!t.validate||t.validate()}var c="unobtrusiveAjaxClick",g="unobtrusiveAjaxClickTarget",s="unobtrusiveValidation";a(document).on("click","a[data-ajax=true]",function(a){a.preventDefault(),o(this,{url:this.href,type:"GET",data:[]})}),a(document).on("click","form[data-ajax=true] input[type=image]",function(e){var t=e.target.name,n=a(e.target),i=a(n.parents("form")[0]),o=n.offset();i.data(c,[{name:t+".x",value:Math.round(e.pageX-o.left)},{name:t+".y",value:Math.round(e.pageY-o.top)}]),setTimeout(function(){i.removeData(c)},0)}),a(document).on("click","form[data-ajax=true] :submit",function(e){var t=e.currentTarget.name,n=a(e.target),i=a(n.parents("form")[0]);i.data(c,t?[{name:t,value:e.currentTarget.value}]:[]),i.data(g,n),setTimeout(function(){i.removeData(c),i.removeData(g)},0)}),a(document).on("submit","form[data-ajax=true]",function(e){var t=a(this).data(c)||[],n=a(this).data(g),i=n&&n.hasClass("cancel");e.preventDefault(),(i||r(this))&&o(this,{url:this.action,type:this.method||"GET",data:t.concat(a(this).serializeArray())})})}(jQuery);var Pagination={code:"",Extend:function(a){a=a||{},Pagination.size=a.size?parseInt(a.size):0,Pagination.page=a.page?parseInt(a.page):0,Pagination.step=a.step?parseInt(a.step):0,Pagination.tagName=a.tagName||"a",Pagination.attribute=a.attribute||"",Pagination.hrefToken=a.hrefToken||"",Pagination.showValue=!!a.showValue||!1,Pagination.submitFromAttributes=null!=a.form?'form="'+a.form+'" type=submit name="PageNumber"':"",Pagination.hover=a.hover||"",Pagination.itemClassName="",a.hover&&(Pagination.itemClassName+=" class='hover-tooltip' ")},Add:function(a,e){for(var t=a;t<e;t++){var n=Pagination.hrefToken?'href="'+Pagination.hrefToken.replace("{PAGE}",t)+'"':"",i=Pagination.showValue?'value="'+t+'"':"",o=Pagination.hover?"<span class='tooltip top'>"+Pagination.hover.replace("{PAGE}",t)+"</span>":"";Pagination.code+="<li"+Pagination.itemClassName+"><"+Pagination.tagName+" "+Pagination.submitFromAttributes+" "+n+" "+i+" "+Pagination.attribute+"data-value="+t+" >"+t+"</"+Pagination.tagName+">"+o+"</li>"}},Last:function(){var a=Pagination.hrefToken?'href="'+Pagination.hrefToken.replace("{PAGE}",Pagination.size>1?Pagination.size:1)+'"':"",e=Pagination.showValue?'value="'+(Pagination.size>1?Pagination.size:1)+'"':"",t=Pagination.hover?"<span class='tooltip top'>"+Pagination.hover.replace("{PAGE}",Pagination.size>1?Pagination.size:1)+"</span>":"";Pagination.code+="<i>...</i><li data-last "+Pagination.itemClassName+" ><"+Pagination.tagName+" "+Pagination.submitFromAttributes+" "+a+" "+e+" "+Pagination.attribute+"data-value="+Pagination.size+">"+Pagination.size+"</"+Pagination.tagName+">"+t+"</li>"},First:function(){var a=Pagination.hrefToken?'href="'+Pagination.hrefToken.replace("{PAGE}",1)+'"':"",e=Pagination.showValue?'value="1"':"",t=Pagination.hover?"<span class='tooltip top'>"+Pagination.hover.replace("{PAGE}",1)+"</span>":"";Pagination.code+="<li data-first "+Pagination.itemClassName+"><"+Pagination.tagName+" "+Pagination.submitFromAttributes+" "+a+" "+e+" "+Pagination.attribute+" data-value=1>1</"+Pagination.tagName+">"+t+"</li><i>...</i>"},Click:function(){Pagination.page=+this.innerHTML,Pagination.Start()},Prev:function(){Pagination.page--,Pagination.page<1&&(Pagination.page=1),Pagination.Start()},Next:function(){Pagination.page++,Pagination.page>Pagination.size&&(Pagination.page=Pagination.size),Pagination.Start()},Bind:function(){for(var a=Pagination.e.getElementsByTagName(Pagination.tagName),e=0;e<a.length;e++)+a[e].innerHTML===Pagination.page&&(a[e].parentElement.className="current"),Pagination.submitFromAttributes||a[e].addEventListener("click",Pagination.Click,!1)},Finish:function(){Pagination.e.innerHTML=Pagination.code,Pagination.code="",Pagination.Bind()},Start:function(){Pagination.size<2*Pagination.step+6?Pagination.Add(1,Pagination.size+1):Pagination.page<2*Pagination.step+1?(Pagination.Add(1,2*Pagination.step+4),Pagination.Last()):Pagination.page>Pagination.size-2*Pagination.step?(Pagination.First(),Pagination.Add(Pagination.size-2*Pagination.step-2,Pagination.size+1)):(Pagination.First(),Pagination.Add(Pagination.page-Pagination.step,Pagination.page+Pagination.step+1),Pagination.Last()),Pagination.Finish()},Buttons:function(a){var e=a.getElementsByTagName(Pagination.tagName);e[0].addEventListener("click",Pagination.Prev,!1),e[1].addEventListener("click",Pagination.Next,!1)},Create:function(a){var e=Pagination.hrefToken?'href="'+Pagination.hrefToken.replace("{PAGE}",Pagination.page>1?Pagination.page-1:1)+'"':"",t=Pagination.hrefToken?'href="'+Pagination.hrefToken.replace("{PAGE}",Pagination.size>Pagination.page?Pagination.page+1:Pagination.size)+'"':"",n=Pagination.showValue?'value="'+(Pagination.page>1?Pagination.page-1:1)+'"':"",i=Pagination.showValue?'value="'+(Pagination.page>1?Pagination.page-1:1)+'"':"",o=["<li"+Pagination.itemClassName+"><"+Pagination.tagName+' class="pre" '+Pagination.submitFromAttributes+" "+n+" "+Pagination.attribute+" "+e+" data-value="+(Pagination.page>1?Pagination.page:1)+" >&#9668;</"+Pagination.tagName+"></li>","<span></span>","<li"+Pagination.itemClassName+"><"+Pagination.tagName+' class="next" '+Pagination.submitFromAttributes+" "+i+" "+Pagination.attribute+" "+t+" data-value="+(Pagination.size>Pagination.page?Pagination.page+1:Pagination.size)+" >&#9658;</"+Pagination.tagName+"></li>"];a.innerHTML=o.join(""),Pagination.e=a.getElementsByTagName("span")[0],Pagination.Buttons(a)},Init:function(a,e){Pagination.Extend(e),Pagination.Create(a),Pagination.Start()},Run:function(){for(var a=document.getElementsByClassName("_p-gination"),e=0;e<a.length;e++){var t=a[e];Pagination.Init(t,t.dataset)}}};document.addEventListener("DOMContentLoaded",Pagination.Run(),!1);var markPlaceAddress,frmAdvanceSearch,rangePriceLabel,rangeRoomLabel,rangeSizeLabel,userInput,fuzzyComplete;document.addEventListener("DOMContentLoaded",function(){InitControls(),InitSlider(),InitComboboxSearchType(),InnitElasticSearch(),BindingEvent()}),document.addEventListener("DOMContentLoaded",function(){InitPaging()}),document.addEventListener("DOMContentLoaded",function(){InitPage(),LoadMap()});