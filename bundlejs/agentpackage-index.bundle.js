"use strict";function innit(){mainPlaceLv2Id1=document.getElementById("mainPlaceLv2Id1"),btnLoadTableMainPlace=document.getElementById("btnLoadTableMainPlace"),mainActicle=document.getElementById("mainActicle"),tab1=document.getElementById("tab1"),tab2=document.getElementById("tab2"),tab3=document.getElementById("tab3"),tab4=document.getElementById("tab4"),tab5=document.getElementById("tab5"),placeLv2Id=document.getElementById("placeLv2Id"),btnLoadTable=document.getElementById("btnLoadTable"),mainPropertyGroupType=document.querySelector("#MainPlaces #SelectedPropertyGroupType"),mainPlaceLevel1=document.querySelector("#MainPlaces #SelectedPlaceLevel1"),mainPlaceLevel2=document.querySelector("#MainPlaces #SelectedPlaceLevel2"),mainPropertyGroup=document.querySelector("#mainPropertyGroup"),subPropertyGroupType=document.querySelector("#SubPlaces #SelectedPropertyGroupType"),subPlaceLevel1=document.querySelector("#SubPlaces #SelectedPlaceLevel1"),subPlaceLevel2=document.querySelector("#SubPlaces #SelectedPlaceLevel2"),subPropertyGroup=document.querySelector("#subPropertyGroup"),subPropertyGroupType.addEventListener("change",function(e){subPlaceLevel2.dispatchEvent(new Site.CreateEvent("change"))}),mainPropertyGroupType.addEventListener("change",function(e){mainPlaceLevel2.dispatchEvent(new Site.CreateEvent("change"))}),mainPlaceLevel1.addEventListener("change",function(e){var t={placeId:+e.target.value};AjaxRequest.SendRequestGetJson("POST","/publicplaces/getchildplaceids",t,function(e){for(var t=JSON.parse(e);mainPlaceLevel2.length>0;)mainPlaceLevel2.remove(mainPlaceLevel2.length-1);for(var a=0;a<t.length;a++){var n=t[a],r=document.createElement("option");r.text=n.longName,r.value=n.id,mainPlaceLevel2.add(r)}mainPlaceLevel2.dispatchEvent(new Site.CreateEvent("change"))})},!1),mainPlaceLevel2.addEventListener("change",function(e){mainPlaceLv2Id1.value=e.target.value,mainPropertyGroup.value=mainPropertyGroupType.value,btnLoadTableMainPlace.click()},!1),subPlaceLevel1.addEventListener("change",function(e){var t={placeId:+e.target.value};AjaxRequest.SendRequestGetJson("POST","/publicplaces/getchildplaceids",t,function(e){for(var t=JSON.parse(e);subPlaceLevel2.length>0;)subPlaceLevel2.remove(subPlaceLevel2.length-1);for(var a=0;a<t.length;a++){var n=t[a],r=document.createElement("option");r.text=n.longName,r.value=n.id,subPlaceLevel2.add(r)}subPlaceLevel2.dispatchEvent(new Site.CreateEvent("change"))})},!1),subPlaceLevel2.addEventListener("change",function(e){placeLv2Id.value=e.target.value,subPropertyGroup.value=subPropertyGroupType.value,btnLoadTable.click()},!1),tab1.addEventListener("change",function(e){scrollTop(),e.target.checked&&history.pushState(null,"Lựa chọn gói Agent","/tro-thanh-agent/1")}),tab2.addEventListener("change",function(e){scrollTop(),e.target.checked&&history.pushState(null,"Chọn khu vực chính","/tro-thanh-agent/2")}),tab3.addEventListener("change",function(e){scrollTop(),e.target.checked&&history.pushState(null,"Chọn khu vực phụ","/tro-thanh-agent/3"),btnLoadTable.click()}),tab4.addEventListener("change",function(e){if(e.target.checked){history.pushState(null,"Tùy chỉnh","/tro-thanh-agent/4");var t,a=document.querySelectorAll("#mainPlaceIdCartContainer ._placeItem");for(t=0;t<a.length;t++)a[t].innerHTML=a[t].innerHTML.replace(/MainPlaceItems(\[\w+\])/g,"MainPlaceItems["+t+"]");for(a=document.querySelectorAll("#placeIdCartContainer ._placeItem"),t=0;t<a.length;t++)a[t].innerHTML=a[t].innerHTML.replace(/SubPlaceItems(\[\w+\])/g,"SubPlaceItems["+t+"]");btnLoadShopingCart=document.getElementById("btnLoadShopingCart"),btnLoadShopingCart.click()}}),tab5.addEventListener("change",function(e){scrollTop(),e.target.checked&&(tab1.disabled=!0,tab2.disabled=!0,tab3.disabled=!0,tab4.disabled=!0,btnLoadInsertShopingCartDb=document.getElementById("btnLoadInsertShopingCartDb"),btnLoadInsertShopingCartDb.click(),history.pushState(null,"Thanh toán","/tro-thanh-agent/5"))})}function AddEventControlTableMainLocality(){for(var e=document.querySelectorAll("._p-main-places-labels [name='AddPlaceId']"),t=0;t<e.length;t++){e[t].addEventListener("click",function(e){var t=document.querySelector('input[name="UserTypeSelected"]:checked').dataset.maxMainPlace,a=document.querySelectorAll("._p-main-places-labels .label._p-place");if("True"!==e.target.dataset.owned&&a.length>=t)return void Site.Notify("Thông báo","Bạn chỉ sở hữu tối đa "+document.querySelector('input[name="UserTypeSelected"]:checked').dataset.maxMainPlace+" khu vực chính với gói Agent hiện tại");var n="Sell"===mainPropertyGroupType.value?"red":"Rent"===mainPropertyGroupType.value?"blue":"green";Site.AddParentClassName(e.target,"_p-item","hide");var r=document.querySelectorAll("._p-main-places-labels ._p-list-places-selected ._"+mainPropertyGroupType.value),c=Site.HtmlToElement("<span data-group-type='"+mainPropertyGroupType.value+"' class='label _p-place _cursor-poiter margin-right animate-all move-in-up "+n+" ' data-id="+e.target.dataset.id+">"+e.target.dataset.placeName+"</span>");r[0].appendChild(c[0]),Site.AddClass("._p-main-places-labels ._"+mainPropertyGroupType.value+" #noDada","hide");var l=document.querySelector("._p-sub-places-labels ._"+mainPropertyGroupType.value+" ._cursor-poiter[data-id='"+e.target.dataset.id+"']");l&&l.click(),mainPlaceIdCartContainer=document.getElementById("mainPlaceIdCartContainer");var i=mainPlaceIdCartContainer.querySelector("#placeIdContainer"+e.target.dataset.id);if(null==i){var o=Site.HtmlToElement('<div class="_placeItem" id="placeIdContainer'+e.target.dataset.id+'"> <input type="hidden" name="MainPlaceItems[NUMBER].Id" value="0"/> <input type="number" name="MainPlaceItems[NUMBER].PlaceId" value="'+e.target.dataset.id+'"/> <input checked="checked" data-val="true" id="MainPlaceItems_'+e.target.dataset.id+'__IsMainPlace" name="MainPlaceItems[NUMBER].IsMainPlace" type="checkbox" value="true"> <input type="number" '+("Project"===mainPropertyGroupType.value?'checked="checked"':"")+' id="MainPlaceItems_'+e.target.dataset.id+'__Month" name="MainPlaceItems[NUMBER].Month" value="1"> <input id="MainPlaceItems_'+e.target.dataset.id+'__ReceiProject" value="true" name="MainPlaceItems[NUMBER].ReceiProject" class="_chkRecei" type="checkbox"> <input '+("Sell"===mainPropertyGroupType.value?'checked="checked"':"")+' id="MainPlaceItems_'+e.target.dataset.id+'__ReceiSell" value="true" name="MainPlaceItems[NUMBER].ReceiSell"  class="_chkRecei"  type="checkbox" > <input type="checkbox" '+("Rent"===mainPropertyGroupType.value?'checked="checked"':"")+' id="MainPlaceItems_'+e.target.dataset.id+'__ReceiRent" value="true" name="MainPlaceItems[NUMBER].ReceiRent"  class="_chkRecei"  /> </div>');mainPlaceIdCartContainer.appendChild(o[0])}var d="MainPlaceItems_"+e.target.dataset.id+"__Recei"+mainPropertyGroupType.value;document.getElementById(d).setAttribute("checked","checked"),document.getElementById(d).checked=!0,AddEventToSpanMainPlace()});for(var a=document.querySelectorAll("._p-main-places-labels ._"+mainPropertyGroupType.value+" ._p-place"),n=0;n<a.length;n++)e[t].dataset.id===a[n].dataset.id&&Site.AddParentClassName(e[t],"_p-item","hide")}}function AddEventToSpanMainPlace(){for(var e=document.querySelectorAll("._p-main-places-labels ._cursor-poiter"),t=0;t<e.length;t++)e[t].addEventListener("click",function(e){if(null!=e.target.parentElement){var t=document.querySelector("#mainPlaceIdCartContainer #placeIdContainer"+e.target.dataset.id);if(t){var a="MainPlaceItems_"+e.target.dataset.id+"__Recei"+e.target.dataset.groupType;document.getElementById(a).removeAttribute("checked"),document.getElementById(a).checked=!1,0===t.querySelectorAll("input[type=checkbox]._chkRecei:checked").length&&t.remove()}if(!e.target.parentElement.classList.contains("_"+mainPropertyGroupType.value)){var n=e.target.parentElement.querySelectorAll("._cursor-poiter");return 1===n.length&&Site.RemoveClassElement(e.target.parentElement.querySelector(" #noDada"),"hide"),void e.target.remove()}var r=document.querySelector("._p-main-places-labels [name='row"+e.target.dataset.id+"']");r&&Site.RemoveClassElement(r,"hide");var c=e.target.parentElement.querySelectorAll("._cursor-poiter");1===c.length&&Site.RemoveClassElement(e.target.parentElement.querySelector(" #noDada"),"hide"),e.target.remove()}})}function AddEventControlTableLocality(){for(var e=document.querySelectorAll("._p-sub-places-labels [name='AddPlaceId']"),t=0;t<e.length;t++){e[t].addEventListener("click",function(e){var t=document.querySelector('input[name="UserTypeSelected"]:checked').dataset.maxSubPlace,a=document.querySelectorAll("._p-sub-places-labels .label._p-place");if("True"!==e.target.dataset.owned&&a.length>=t)return void Site.Notify("Thông báo","Khu vực chính hoặc bạn chỉ sở hữu tối đa "+document.querySelector('input[name="UserTypeSelected"]:checked').dataset.maxSubPlace+" khu vực phụ với gói Agent hiện tại");var n="Sell"===subPropertyGroupType.value?"red":"Rent"===mainPropertyGroupType.value?"blue":"green";Site.AddParentClassName(e.target,"_p-item","hide");var r=document.querySelectorAll("._p-sub-places-labels ._p-list-places-selected ._"+subPropertyGroupType.value),c=Site.HtmlToElement("<span data-group-type='"+subPropertyGroupType.value+"' class='label "+n+" _p-place _cursor-poiter margin-right animate-all move-in-up' data-id="+e.target.dataset.id+">"+e.target.dataset.placeName+"</span>");r[0].appendChild(c[0]),Site.AddClass("._p-sub-places-labels ._"+subPropertyGroupType.value+" #noDada","hide");var l=document.querySelector("._p-main-places-labels ._"+subPropertyGroupType.value+" ._cursor-poiter[data-id='"+e.target.dataset.id+"']");l&&l.click(),subPlaceIdCartContainer=document.getElementById("placeIdCartContainer");var i=subPlaceIdCartContainer.querySelector("#placeIdContainer"+e.target.dataset.id);if(null==i){var o=Site.HtmlToElement('<div class="_placeItem" id="placeIdContainer'+e.target.dataset.id+'"> <input type="hidden" name="SubPlaceItems[NUMBER].Id" value="0"/> <input type="number" name="SubPlaceItems[NUMBER].PlaceId" value="'+e.target.dataset.id+'"/> <input data-val="true" id="SubPlaceItems_'+e.target.dataset.id+'__IsMainPlace" name="SubPlaceItems[NUMBER].IsMainPlace" type="checkbox" value="true"> <input type="number" '+("Project"===subPropertyGroupType.value?'checked="checked"':"")+' id="SubPlaceItems_'+e.target.dataset.id+'__Month" name="SubPlaceItems[NUMBER].Month" value="1"> <input id="SubPlaceItems_'+e.target.dataset.id+'__ReceiProject" name="SubPlaceItems[NUMBER].ReceiProject" type="checkbox"  class="_chkRecei"  value="true"> <input '+("Sell"===subPropertyGroupType.value?'checked="checked"':"")+' id="SubPlaceItems_'+e.target.dataset.id+'__ReceiSell" name="SubPlaceItems[NUMBER].ReceiSell"  class="_chkRecei"  type="checkbox" value="true"> <input type="checkbox" '+("Rent"===subPropertyGroupType.value?'checked="checked"':"")+' id="SubPlaceItems_'+e.target.dataset.id+'__ReceiRent" name="SubPlaceItems[NUMBER].ReceiRent" value="true"  class="_chkRecei" /> </div>');placeIdCartContainer=document.getElementById("placeIdCartContainer"),placeIdCartContainer.appendChild(o[0])}var d="SubPlaceItems_"+e.target.dataset.id+"__Recei"+subPropertyGroupType.value;document.getElementById(d).setAttribute("checked","checked"),document.getElementById(d).checked=!0,AddEventToSpanSubPlace()});for(var a=document.querySelectorAll("._p-sub-places-labels ._"+subPropertyGroupType.value+" ._cursor-poiter,._p-main-places-labels ._"+subPropertyGroupType.value+" ._cursor-poiter"),n=0;n<a.length;n++)e[t].dataset.id===a[n].dataset.id&&Site.AddParentClassName(e[t],"_p-item","hide")}}function AddEventToSpanSubPlace(){for(var e=document.querySelectorAll("._p-sub-places-labels ._cursor-poiter"),t=0;t<e.length;t++)e[t].addEventListener("click",function(e){if(null!=e.target.parentElement){var t=document.querySelector("#placeIdCartContainer #placeIdContainer"+e.target.dataset.id);if(t){var a="SubPlaceItems_"+e.target.dataset.id+"__Recei"+e.target.dataset.groupType;document.getElementById(a).removeAttribute("checked"),document.getElementById(a).checked=!1,0===t.querySelectorAll("input[type=checkbox]._chkRecei:checked").length&&t.remove()}if(!e.target.parentElement.classList.contains("_"+subPropertyGroupType.value)){var n=e.target.parentElement.querySelectorAll("._cursor-poiter");return 1===n.length&&Site.RemoveClassElement(e.target.parentElement.querySelector(" #noDada"),"hide"),void e.target.remove()}var r=document.querySelector("._p-sub-places-labels [name='row"+e.target.dataset.id+"']");r&&Site.RemoveClassElement(r,"hide");var c=e.target.parentElement.querySelectorAll("._cursor-poiter");1===c.length&&Site.RemoveClassElement(e.target.parentElement.querySelector(" #noDada"),"hide"),e.target.remove()}})}function scrollTop(){var e=new SmoothScroll,t=document.querySelector("#mainActicle");e.animateScroll(t)}function LoadPaymentButton(){for(var e=document.querySelectorAll("[data-ref-shopingcart]"),t=0;t<e.length;t++)"#frmShopingCart"===e[t].dataset.refShopingcart&&null!==e[t].shopingCartId&&(e[t].shopingCartId.setAttribute("value",window.frmShopingCart.Id.value),"0"!==window.frmShopingCart.Id.value&&e[t].querySelector("[name=submitType]").click())}function InnitShopingCart(){txtMonthAgentPackage=document.getElementById("txtMonthAgentPackage"),hiddenAgentPackageMonth=document.getElementById("hiddenAgentPackageMonth"),packageAgentMoney=document.getElementById("packageAgentMoney"),tdSum=document.getElementById("tdSum"),txtMonthAgentPackage.addEventListener("change",function(e){hiddenAgentPackageMonth.value=e.target.value,UpdatePrice()});for(var e=document.querySelectorAll("[data-target-td-selector]"),t=0;t<e.length;t++)e[t].addEventListener("change",function(e){var t="true"===e.target.dataset.isMain,a=document.getElementById((t?"Main":"Sub")+"PlaceItem_"+e.target.dataset.id+"__Month");a.value=e.target.value,UpdatePrice()})}function UpdatePrice(){var e=txtMonthAgentPackage.value*txtMonthAgentPackage.dataset.price;packageAgentMoney.innerText=new Intl.NumberFormat("en-Us",{minimumFractionDigits:0}).format(e);for(var t=document.querySelectorAll("[data-target-td-selector]"),a=0;a<t.length;a++){var n=document.querySelector(t[a].dataset.targetTdSelector),r=t[a].value*t[a].dataset.price;n.innerText=new Intl.NumberFormat("en-Us",{minimumFractionDigits:0}).format(r),e+=r}tdSum.innerText=new Intl.NumberFormat("en-Us",{minimumFractionDigits:0}).format(e)}function InnitShopingCartPayment(){chkPayment1.addEventListener("change",function(e){Site.AddClass(".quote,._p-button-payment","hide"),Site.RemoveClass("._p-payment-1","hide")},!1),chkPayment2&&chkPayment2.addEventListener("change",function(e){Site.AddClass(".quote,._p-button-payment","hide"),Site.RemoveClass("._p-payment-2","hide")},!1),chkPayment3&&chkPayment3.addEventListener("change",function(e){Site.AddClass(".quote,._p-button-payment","hide"),Site.RemoveClass("._p-payment-3","hide")},!1)}!function(e){function t(e,t){for(var a=window,n=(e||"").split(".");a&&n.length;)a=a[n.shift()];return"function"==typeof a?a:(t.push(e),Function.constructor.apply(null,t))}function a(e){return"GET"===e||"POST"===e}function n(e,t){a(t)||e.setRequestHeader("X-HTTP-Method-Override",t)}function r(t,a,n){var r;a&&void 0!==a.isUpdateLayout&&!a.isUpdateLayout||n.indexOf("application/x-javascript")===-1&&(r=(t.getAttribute("data-ajax-mode")||"").toUpperCase(),e(t.getAttribute("data-ajax-update")).each(function(t,n){var c;switch(r){case"BEFORE":c=n.firstChild,e("<div />").html(a).contents().each(function(){n.insertBefore(this,c)});break;case"AFTER":e("<div />").html(a).contents().each(function(){n.appendChild(this)});break;case"REPLACE-WITH":e(n).replaceWith(a);break;default:e(n).html(a)}}))}function c(c,l){var i,o,d,u;i=c.getAttribute("data-ajax-confirm"),i&&!window.confirm(i)||(o=e(c.getAttribute("data-ajax-loading")),u=parseInt(c.getAttribute("data-ajax-loading-duration"),10)||0,e.extend(l,{type:c.getAttribute("data-ajax-method")||void 0,url:c.getAttribute("data-ajax-url")||void 0,cache:!!c.getAttribute("data-ajax-cache"),beforeSend:function(e){var a;return n(e,d),a=t(c.getAttribute("data-ajax-begin"),["xhr"]).apply(c,arguments),a!==!1&&o.show(u),a},complete:function(){o.hide(u),t(c.getAttribute("data-ajax-complete"),["xhr","status"]).apply(c,arguments),console.log("complete")},success:function(e,a,n){r(c,e,n.getResponseHeader("Content-Type")||"text/html"),t(c.getAttribute("data-ajax-success"),["data","status","xhr"]).apply(c,arguments),console.log("success")},error:function(){t(c.getAttribute("data-ajax-failure"),["xhr","status","error"]).apply(c,arguments),console.log("error")}}),l.data.push({name:"X-Requested-With",value:"XMLHttpRequest"}),d=l.type.toUpperCase(),a(d)||(l.type="POST",l.data.push({name:"X-HTTP-Method-Override",value:d})),e.ajax(l))}function l(t){var a=e(t).data(d);return!a||!a.validate||a.validate()}var i="unobtrusiveAjaxClick",o="unobtrusiveAjaxClickTarget",d="unobtrusiveValidation";e(document).on("click","a[data-ajax=true]",function(e){e.preventDefault(),c(this,{url:this.href,type:"GET",data:[]})}),e(document).on("click","form[data-ajax=true] input[type=image]",function(t){var a=t.target.name,n=e(t.target),r=e(n.parents("form")[0]),c=n.offset();r.data(i,[{name:a+".x",value:Math.round(t.pageX-c.left)},{name:a+".y",value:Math.round(t.pageY-c.top)}]),setTimeout(function(){r.removeData(i)},0)}),e(document).on("click","form[data-ajax=true] :submit",function(t){var a=t.currentTarget.name,n=e(t.target),r=e(n.parents("form")[0]);r.data(i,a?[{name:a,value:t.currentTarget.value}]:[]),r.data(o,n),setTimeout(function(){r.removeData(i),r.removeData(o)},0)}),e(document).on("submit","form[data-ajax=true]",function(t){var a=e(this).data(i)||[],n=e(this).data(o),r=n&&n.hasClass("cancel");t.preventDefault(),(r||l(this))&&c(this,{url:this.action,type:this.method||"GET",data:a.concat(e(this).serializeArray())})})}(jQuery);var mainPlaceLv2Id1,btnLoadTableMainPlace,mainActicle,ownedMainPlaces,ownedSubPlaces,tab3,tab4,tab5,tab1,tab2,placeLv2Id,btnLoadTable,btnLoadShopingCart,btnLoadInsertShopingCartDb,mainPlaceIdCartContainer,placeIdCartContainer,mainPropertyGroupType,mainPropertyGroup,mainPlaceLevel1,mainPlaceLevel2,subPropertyGroupType,subPlaceLevel1,subPlaceLevel2,subPropertyGroup;document.addEventListener("DOMContentLoaded",function(){innit(),subPlaceLevel2=document.querySelector("#SubPlaces #SelectedPlaceLevel2"),subPlaceLevel2.dispatchEvent(new Site.CreateEvent("change")),mainPlaceLevel2=document.querySelector("#MainPlaces #SelectedPlaceLevel2"),mainPlaceLevel2.dispatchEvent(new Site.CreateEvent("change")),"3"===mainActicle.dataset.step&&tab3.dispatchEvent(new Site.CreateEvent("change")),"4"===mainActicle.dataset.step?tab4.dispatchEvent(new Site.CreateEvent("change")):"5"===mainActicle.dataset.step&&tab5.dispatchEvent(new Site.CreateEvent("change"))});var txtMonthAgentPackage,hiddenAgentPackageMonth,packageAgentMoney,tdSum;document.addEventListener("DOMContentLoaded",function(){InnitShopingCart()});var chkPayment1=document.getElementById("chkPayment1"),chkPayment2=document.getElementById("chkPayment2"),chkPayment3=document.getElementById("chkPayment3");document.addEventListener("DOMContentLoaded",function(){InnitShopingCartPayment()});