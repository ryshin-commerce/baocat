"use strict";function InitControls(){markPlaceAddress=document.getElementById("markPlaceAddress"),frmAdvanceSearch=document.getElementById("frmAdvanceSearch"),rangePriceLabel=document.getElementById("rangePriceLabel"),rangeRoomLabel=document.getElementById("rangeRoomLabel"),rangeSizeLabel=document.getElementById("rangeSizeLabel"),userInput=document.getElementById("UserInput")}function BindingEvent(){markPlaceAddress.addEventListener("keypress",function(e){var t=e.keyCode?e.keyCode:e.which;13===t&&btnSearch.click()}),markPlaceAddress.addEventListener("keyup",function(e){userInput.value=e.target.value})}function InitComboboxSearchType(){var e=document.getElementById("SelectedPropertyGroupType");e.addEventListener("change",function(e){Site.RemoveClass("._p-check-property-type","show"),Site.AddClass("._p-check-property-type","hide");for(var t=e.target.value,a=document.querySelectorAll("._p-check-property-type"),n=0;n<a.length;n++){var r=a[n];if(r.dataset.value===t){Site.RemoveClassElement(r,"hide"),Site.AddClassElement(r,"show");var i=r.dataset.refix;frmAdvanceSearch.action=frmAdvanceSearch.dataset.actionTemplate.replace("REFIX",i).replace("{PAGE}",1)}}}),e.dispatchEvent(new Site.CreateEvent("change"))}function InnitElasticSearch(){var e=LocalStorageHelper.Get(LocalStogeEnum.SELECTED_LOCATION_STORAGE_NAME);fuzzyComplete=new BcFuzzySearch,fuzzyComplete.Init("#markPlaceAddress",null!=e?e.id:null,null!=e?e.address:"","address","id",LocalStogeEnum.ALL_PLACES,bindingDataCompleteCallBack,bindingDataFailedCallback,selectionCallback,"#frmAdvanceSearch #PlaceId",10,3),e&&(markPlaceAddress.value=e.address)}function bindingDataCompleteCallBack(e,t){}function bindingDataFailedCallback(e,t){Site.NotifyFormFailed("LỖI","Lấy dự liệu thất bại. Vui lòng làm mới lại trang. Hoặc thông báo cho chugn1 tôi biết quá webmaster@baocat.vn")}function selectionCallback(e,t,a){if(console.log(a),t){LocalStorageHelper.Save(LocalStogeEnum.SELECTED_LOCATION_STORAGE_NAME,{id:a,address:t.item.display});var n=SeoUrl.MapSearchUrl(frmAdvanceSearch.dataset.refix,t.item.display,a,1);frmAdvanceSearch.action=n}else frmSubmit.placeId.value=null}function InputSearchInputCallBack(e){}function InitSlider(){var e,t,a=document.getElementById("rangePrice");noUiSlider.create(a,{range:{min:[0],"5%":[2e8,1e8],"70%":[4e9,1e9],"80%":[1e10,2e9],"95%":[2e10,5e9],max:[25e9]},start:[0,25e9],step:1e8,connect:!0,pips:{mode:"count",values:9,density:2,stepped:!0,format:wNumb({decimals:0,edit:function(e){return e=+e,0===e?0:25e9===e?"...":e<1e9?e/1e6+" tr":e/1e9+" tỷ"}})}}),e=a.dataset.min||0,t=a.dataset.max||99999999999999,a.noUiSlider.set([e,t]),a.noUiSlider.on("update",function(e,t){var a,n;frmAdvanceSearch.RangePriceMin.value=null,frmAdvanceSearch.RangePriceMax.value=null,0===+e[0]?a="Dưới ":25e9===+e[0]?a="":+e[0]<1e9?(a=+e[0]/1e6+" triệu",frmAdvanceSearch.RangePriceMin.value=+e[0]):(a=+e[0]/1e9+" tỷ",frmAdvanceSearch.RangePriceMin.value=+e[0]),0===+e[1]?a="":25e9===+e[1]?0===+e[0]?(n="Tất cả",a=""):(n="",a="Trên "+a):+e[1]<1e9?(n=+e[1]/1e6+" triệu",frmAdvanceSearch.RangePriceMax.value=+e[1]):(n=+e[1]/1e9+" tỷ",frmAdvanceSearch.RangePriceMax.value=+e[1]),n===a&&(a=""),""!==a&&""!==n&&0!==+e[0]&&(a+=" - "),rangePriceLabel.innerText=a+n});var n=document.getElementById("rangeRoom");noUiSlider.create(n,{range:{min:[0],"95%":[10,1],max:[11]},start:[0,100],step:1,stepped:!0,connect:!0,pips:{mode:"count",values:12,density:1,stepped:!0,format:wNumb({decimals:0,edit:function(e){return e=+e,0===e?0:11===e?"...":e}})}}),e=n.dataset.min||0,t=n.dataset.max||99999999999999,n.noUiSlider.set([e,t]),n.noUiSlider.on("update",function(e,t){var a,n;frmAdvanceSearch.RangeRoomMin.value=null,frmAdvanceSearch.RangeRoomMax.value=null,0===+e[0]?a="Dưới ":11===+e[0]?a="":(a=+e[0],frmAdvanceSearch.RangeRoomMin.value=+e[0]),0===+e[1]?a="":11===+e[1]?0===+e[0]?(n="Tất cả",a=""):(n="",a="Trên "+a):(n=+e[1],frmAdvanceSearch.RangeRoomMax.value=+e[1]),n===a&&(a=""),""!==a&&""!==n&&0!==+e[0]&&(a+=" - "),rangeRoomLabel.innerText=a+n});var r=document.getElementById("rangeSize");noUiSlider.create(r,{range:{min:[0],"5%":[20,10],"30%":[100,10],"70%":[300,10],"95%":[1e3,10],max:[1010]},start:[0,1e4],step:10,density:1,connect:!0,pips:{mode:"values",values:[30,50,100,150,200,250,300,500,700,900,1010],format:wNumb({decimals:0,edit:function(e){return e=+e,0===e?0:1010===e?"...":e}})}}),e=r.dataset.min||0,t=r.dataset.max||99999999999999,r.noUiSlider.set([e,t]),r.noUiSlider.on("update",function(e,t){var a,n;frmAdvanceSearch.RangeSizeMin.value=null,frmAdvanceSearch.RangeSizeMax.value=null,0===+e[0]?a="Dưới ":1010===+e[0]?a="":(a=+e[0],frmAdvanceSearch.RangeSizeMin.value=Math.round(e[0])),0===+e[1]?a="":1010===+e[1]?0===+e[0]?(n="Tất cả",a=""):(n="",a="Trên "+a+" m<sup class='text-12'>2<sup/>"):(n=+e[1]+" m<sup class='text-12'>2<sup/>",frmAdvanceSearch.RangeSizeMax.value=Math.round(e[1])),n===a&&(a=""),""!==a&&""!==n&&0!==+e[0]&&(a+=" - "),rangeSizeLabel.innerHTML=a+n})}function ReBindingView(){Site.ReValidateForm(document.querySelectorAll("[data-form-submit-lead]")),LoadCleave(),LoadSwiperAgent(),AddEventDropdownList()}function AddEventDropdownList(){var e=document.querySelector("[name='LeadDataModel.RoomMin']"),t=document.querySelector("[name='LeadDataModel.RoomMax']");UpdateEventCuple(e,t);var a=document.querySelector("[name='LeadDataModel.RoadMin']"),n=document.querySelector("[name='LeadDataModel.RoadMax']");UpdateEventCuple(a,n);var r=document.querySelector("[name='LeadDataModel.SizeMin']"),i=document.querySelector("[name='LeadDataModel.SizeMax']");UpdateEventCuple(r,i);var d=document.querySelector("[name='LeadDataModel.PriceMin']"),o=document.querySelector("[name='LeadDataModel.PriceMax']");UpdateEventCuple(d,o)}function UpdateEventCuple(e,t){e&&t&&e.addEventListener("change",function(e){for(var a=+e.target.value,n=t.querySelectorAll("option"),r=0;r<n.length;r++)+n[r].value<a?n[r].setAttribute("disabled",""):n[r].removeAttribute("disabled");a>t.value&&(t.selectedIndex=0)})}function LoadSwiperAgent(){var e=document.querySelector("._p-SliderAgentContactForm .swiper-container");e&&(swiperAgent=new Swiper(e,{paginationType:"fraction",effect:"flip",initialSlide:+e.dataset.activeSlide,grabCursor:!0,loop:!0,navigation:{nextEl:".fa-angle-left",prevEl:".fa-angle-right"},pagination:{el:"._p-paging"}}),swiperAgent.on("slideChange",function(){var e=swiperAgent.slides[swiperAgent.activeIndex],t=document.querySelector("[name='LeadDataModel.ReceiAgentId']");t.value=e.dataset.agentId;var a=e.dataset.agentImage,n=document.querySelector("[data-agent-thank-image]");n&&n.setAttribute("src",a);var r=e.dataset.agentName,i=document.querySelector("[data-agent-thank-name]");i&&(i.innerText=r),UpdateBtn()}),UpdateBtn())}function UpdateBtn(){var e=swiperAgent.slides[swiperAgent.activeIndex],t=document.querySelector("._p-SliderAgentContactForm [data-btn]");+e.dataset.curentLead>+e.dataset.maxLead?t.setAttribute("disabled","disabled"):t.removeAttribute("disabled")}function LoadCleave(){for(var e=document.querySelectorAll("[name='LeadDataModel.PhoneNumber']"),t=0;t<e.length;t++){new Cleave(e[t],{numericOnly:!0,delimiters:[" ",".",".","."],prefix:"+84",blocks:[3,3,3,5]})}}function InitAgentTableRow(){var e=document.querySelectorAll("[data-agent-container] [data-target-model]");frmLoadContact=document.getElementById("formShowContactLazy"),txtUserId=frmLoadContact.querySelector("[name=UserId]"),btnSubmitModel=frmLoadContact.querySelector("[type=submit]");for(var t=0;t<e.length;t++){var a=e[t];a.addEventListener("click",function(e){txtUserId.value=e.target.dataset.userId,btnSubmitModel.click()})}}function innitSearchAgentPage(){frmSearchAgentByPlace=document.getElementById("frmSearchAgentByPlace"),txtSearch=document.getElementById("txtSearch"),placeId=document.getElementById("placeId")}function elasticSearchBinding(){fuzzyComplete=new BcFuzzySearch,fuzzyComplete.Init("#txtSearch",+frmSearchAgentByPlace.dataset.placeId,frmSearchAgentByPlace.dataset.placeAddress,"address","id",LocalStogeEnum.ALL_PLACES,bindingDataCompleteCallBack,bindingDataFailedCallback,selectionCallback,"#placeId",10,3)}function bindingDataCompleteCallBack(){}function bindingDataFailedCallback(){}function selectionCallback(e,t,a){t&&(LocalStorageHelper.Save(LocalStogeEnum.SELECTED_LOCATION_STORAGE_NAME,{id:a,address:t.item.display}),placeId.value=a)}!function(e){function t(e,t){for(var a=window,n=(e||"").split(".");a&&n.length;)a=a[n.shift()];return"function"==typeof a?a:(t.push(e),Function.constructor.apply(null,t))}function a(e){return"GET"===e||"POST"===e}function n(e,t){a(t)||e.setRequestHeader("X-HTTP-Method-Override",t)}function r(t,a,n){var r;a&&void 0!==a.isUpdateLayout&&!a.isUpdateLayout||n.indexOf("application/x-javascript")===-1&&(r=(t.getAttribute("data-ajax-mode")||"").toUpperCase(),e(t.getAttribute("data-ajax-update")).each(function(t,n){var i;switch(r){case"BEFORE":i=n.firstChild,e("<div />").html(a).contents().each(function(){n.insertBefore(this,i)});break;case"AFTER":e("<div />").html(a).contents().each(function(){n.appendChild(this)});break;case"REPLACE-WITH":e(n).replaceWith(a);break;default:e(n).html(a)}}))}function i(i,d){var o,c,l,u;o=i.getAttribute("data-ajax-confirm"),o&&!window.confirm(o)||(c=e(i.getAttribute("data-ajax-loading")),u=parseInt(i.getAttribute("data-ajax-loading-duration"),10)||0,e.extend(d,{type:i.getAttribute("data-ajax-method")||void 0,url:i.getAttribute("data-ajax-url")||void 0,cache:!!i.getAttribute("data-ajax-cache"),beforeSend:function(e){var a;return n(e,l),a=t(i.getAttribute("data-ajax-begin"),["xhr"]).apply(i,arguments),a!==!1&&c.show(u),a},complete:function(){c.hide(u),t(i.getAttribute("data-ajax-complete"),["xhr","status"]).apply(i,arguments),console.log("complete")},success:function(e,a,n){r(i,e,n.getResponseHeader("Content-Type")||"text/html"),t(i.getAttribute("data-ajax-success"),["data","status","xhr"]).apply(i,arguments),console.log("success")},error:function(){t(i.getAttribute("data-ajax-failure"),["xhr","status","error"]).apply(i,arguments),console.log("error")}}),d.data.push({name:"X-Requested-With",value:"XMLHttpRequest"}),l=d.type.toUpperCase(),a(l)||(d.type="POST",d.data.push({name:"X-HTTP-Method-Override",value:l})),e.ajax(d))}function d(t){var a=e(t).data(l);return!a||!a.validate||a.validate()}var o="unobtrusiveAjaxClick",c="unobtrusiveAjaxClickTarget",l="unobtrusiveValidation";e(document).on("click","a[data-ajax=true]",function(e){e.preventDefault(),i(this,{url:this.href,type:"GET",data:[]})}),e(document).on("click","form[data-ajax=true] input[type=image]",function(t){var a=t.target.name,n=e(t.target),r=e(n.parents("form")[0]),i=n.offset();r.data(o,[{name:a+".x",value:Math.round(t.pageX-i.left)},{name:a+".y",value:Math.round(t.pageY-i.top)}]),setTimeout(function(){r.removeData(o)},0)}),e(document).on("click","form[data-ajax=true] :submit",function(t){var a=t.currentTarget.name,n=e(t.target),r=e(n.parents("form")[0]);r.data(o,a?[{name:a,value:t.currentTarget.value}]:[]),r.data(c,n),setTimeout(function(){r.removeData(o),r.removeData(c)},0)}),e(document).on("submit","form[data-ajax=true]",function(t){var a=e(this).data(o)||[],n=e(this).data(c),r=n&&n.hasClass("cancel");t.preventDefault(),(r||d(this))&&i(this,{url:this.action,type:this.method||"GET",data:a.concat(e(this).serializeArray())})})}(jQuery);var markPlaceAddress,frmAdvanceSearch,rangePriceLabel,rangeRoomLabel,rangeSizeLabel,userInput,fuzzyComplete;document.addEventListener("DOMContentLoaded",function(){InitControls(),InitSlider(),InitComboboxSearchType(),InnitElasticSearch(),BindingEvent()});var swiperAgent=null;document.addEventListener("DOMContentLoaded",function(){});var frmSearchAgentByPlace,txtSearch,fuzzyComplete,placeId,frmLoadContact,txtUserId,btnSubmitModel;document.addEventListener("DOMContentLoaded",function(){innitSearchAgentPage(),elasticSearchBinding(),InitAgentTableRow()});